(window.webpackJsonp=window.webpackJsonp||[]).push([["page-tree~b59ad437"],{"0+uK":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("H5qd");const r=a.n(n).a`query WebItemLocationQuery($location:String$locations:[String]$contentId:ID$spaceKey:String$version:Int){webItemSections(location:$location locations:$locations contentId:$contentId key:$spaceKey version:$version){id label styleClass items{accessKey completeKey hasCondition id icon{path}params{key value}label moduleKey section styleClass tooltip url urlWithoutContextPath weight}}}`},"0ItC":function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a("ERkP"),r=a.n(n);const s=({children:e,delay:t})=>{const[a,s]=Object(n.useState)(!1);return Object(n.useEffect)(()=>{const e=setTimeout(()=>s(!0),t>0?t:0);return()=>clearTimeout(e)},[t]),a?r.a.createElement(n.Fragment,null,e):null}},"1N1n":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"e",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"b",(function(){return d})),a.d(t,"c",(function(){return g}));var n=a("Czhu"),r=a("ERkP"),s=a.n(r);const i="confluence.frontend.quick.reload.spa";let o,l;!function(e){e.content="content",e.comment="comment"}(o||(o={})),function(e){e[e.immediate=0]="immediate",e[e.normal=1]="normal",e[e.background=2]="background"}(l||(l={}));const c=async(e,t)=>{const a=Object.keys(e).reduce((t,a)=>{const n=e[a],r=Number(n.priority||l.immediate);return t[r]?t[r].push(n):t[r]=[n],t},[]);for(const n of a)if(n){const e=n.map(e=>e.reload(t));await Promise.all(e)}},d=s.a.createContext({registerReloader:()=>{},reloaders:{[o.content]:async()=>{},[o.comment]:async()=>{}}}),g=({contentId:e,children:t})=>{const[a,i]=Object(r.useState)({}),[l,g]=Object(r.useState)({}),p={[o.content]:i,[o.comment]:g};Object(r.useLayoutEffect)(()=>()=>{i({}),g({})},[e]);const u={contentId:e,registerReloader:e=>{e.types.forEach(t=>{(0,p[t])(t=>Object(n.a)(Object(n.a)({},t),{},{[e.name]:e}))})},reloaders:{[o.content]:e=>c(a,e),[o.comment]:e=>c(l,e)}};return s.a.createElement(d.Provider,{value:u},t)}},"2z5K":function(e,t,a){var n=a("YpBQ"),r=a("S3pA"),s=a("R3TX"),i=a("s+R0"),o=a("Ndl3"),l=a("p1C/"),c=s((function(e){var t=l(e);return o(t)&&(t=void 0),i(n(e,1,o,!0),r(t,2))}));e.exports=c},"3Z2R":function(e,t,a){"use strict";var n=a("Czhu"),r=a("zjfJ"),s=a("ERkP"),i=a.n(s),o=(a("aWzz"),a("gQ5V")),l=a("yjkv"),c=a.n(l),d=a("jLkM"),g=a.n(d),p=a("aoYE");class u extends s.Component{constructor(...e){super(...e),Object(r.a)(this,"state",{superBatchLoaded:!1})}componentDidMount(){this.mounted=!0;const{webItems:e,onLoad:t,waitForSuperBatch:a}=this.props;t&&t({webItems:e}),a&&Object(p.a)().then(()=>{this.mounted&&this.setState({superBatchLoaded:!0})})}componentWillUnmount(){this.mounted=!1}render(){const{id:e,tagName:t,className:a,style:n,children:r,webItems:s,webSections:o,location:l,contentId:c,waitForSuperBatch:d}=this.props;if(d&&!this.state.superBatchLoaded)return null;const g={"data-webitem-location":l,"data-content-id":c,children:"function"==typeof r?r({webItems:s,webSections:o}):null};return e&&(g.id=e),a&&(g.className=a),n&&(g.style=n),i.a.createElement(t,g)}}Object(r.a)(u,"defaultProps",{tagName:"div"});var h=a("0+uK");a.d(t,"a",(function(){return m}));class m extends s.Component{constructor(...e){super(...e),Object(r.a)(this,"experienceSuccess",e=>{this.props.experienceSuccess&&this.props.experienceSuccess(e)})}render(){const{location:e,children:t,onLoad:a,hasMultipleSections:r,renderWhenLoading:s,allowedWebItems:l,notAllowedWebItems:d,fetchPolicy:p,spaceKey:m,contentId:f,id:b,className:E,style:I,tagName:P,version:y,waitForSuperBatch:v}=this.props,O={location:Array.isArray(e)?null:e,locations:Array.isArray(e)?e:[],contentId:f||null,spaceKey:m||null,version:y||null};return i.a.createElement(o.b,{query:h.a,variables:O,fetchPolicy:p},({data:o,loading:p,error:h})=>{var m;if(h)return null;if(p&&!o)return s&&"function"==typeof t?t({loading:p}):null;let f=((null!=(m=o)?m.webItemSections:m)||[]).reduce((e,t)=>e.concat((t.items||[]).map(e=>Object(n.a)(Object(n.a)({},e),{},{parentSection:{label:t.label||t.styleClass}}))),[]);f=c()(f,"completeKey"),l&&(f=f.filter(e=>l.includes(e.completeKey))),d&&(f=f.filter(e=>!d.includes(e.completeKey))),f.forEach(e=>{const t={};if(Array.isArray(e.params)&&(e.params.forEach(e=>{t[e.key]=e.value}),e.params=t),e.section&&-1!==e.section.indexOf("/")){const t=e.section.split("/");e.webSection=t[1]}});let y=[];return r&&(y=g()(f.map(e=>e.section))),f.sort((e,t)=>e.weight-t.weight==0?e.label.localeCompare(t.label):e.weight-t.weight),p||this.experienceSuccess(!0),i.a.createElement(u,{id:b,className:E,style:I,tagName:P,location:e,webItems:f,webSections:y,onLoad:a,waitForSuperBatch:v},t)})}}Object(r.a)(m,"defaultProps",{fetchPolicy:"cache-and-network"})},DQJm:function(e,t,a){"use strict";var n=a("ERkP"),r=a.n(n),s=a("QaQC"),i=a("UKxw"),o=a("Ci1n");t.a=e=>{const{shouldRender:t}=Object(o.c)();if(!t)return null;const a=Object(i.c)(i.d,e.cssFn);return r.a.createElement(s.a,Object.assign({},e,{cssFn:a}))}},Dsoe:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a("ERkP"),r=a("hpu0");class s extends n.Component{constructor(e){super(e),this.markExperienceStart()}markExperienceStart(){const{id:e,name:t,timeout:a,attributes:n,collect:s,onSuccess:i}=this.props;Object(r.b)().start({attributes:n,name:t,timeout:a,id:e,collect:s,onSuccess:i})}render(){return null}}},GFmV:function(e,t,a){"use strict";a.d(t,"g",(function(){return g})),a.d(t,"e",(function(){return p})),a.d(t,"b",(function(){return u})),a.d(t,"d",(function(){return h})),a.d(t,"h",(function(){return m})),a.d(t,"c",(function(){return f})),a.d(t,"a",(function(){return b})),a.d(t,"f",(function(){return E}));var n=a("Czhu"),r=a("EfWO"),s=a.n(r),i=a("frZf"),o=a("ViWs");const l="createBlankFabricPage",c="parentPageId",d="spaceKey",g=e=>{const t=e[l];return"string"==typeof t?"true"===t:!!t},p=e=>{const t={};return e[c]&&(t.parentPageId=e[c]),e[d]&&(t.spaceKey=e[d]),t},u=(e,t={})=>({[l]:e||null,[c]:t.parentPageId||null,[d]:t.spaceKey||null}),h=e=>(e=>{const t=e.getBooleanValue("confluence.frontend.fabric.editor.blank.page",{default:!1,shouldTrackExposureEvent:!1}),a=e.getBooleanValue("confluence.frontend.fabric.editor.all-pages",{default:!1,shouldTrackExposureEvent:!1});return t||a})(e)&&Object(o.a)(e),m=(e,t)=>{var a,n,r;if((null!=(r=e)&&null!=(r=r.content)&&null!=(r=r.nodes)&&null!=(r=r[0])&&null!=(r=r.space)?r.key:r)!==t)return!1;if("page"!==(null!=(n=e)&&null!=(n=n.content)&&null!=(n=n.nodes)&&null!=(n=n[0])?n.type:n))return!1;const s=null!=(a=e)&&null!=(a=a.content)&&null!=(a=a.nodes)&&null!=(a=a[0])?a.operations:a;return!!(s&&s.find(e=>"page"===e.targetType&&"create"===e.operation))},f=(e,t)=>({value:e||t,usedOverride:!!e}),b=(e,t)=>{const a=s.a.parse(e,!0);return s.a.format(Object(n.a)(Object(n.a)({},a),{},{search:void 0,query:Object(n.a)(Object(n.a)({},a.query),t)}))},E=e=>{if(!e)throw new Error("No url for new content");return e.startsWith(i.a)?e:`${i.a}${e}`}},JfpG:function(e,t,a){"use strict";a.r(t);var n=a("ERkP"),r=a.n(n),s=a("lZoD"),i=a("FdGg"),o=a("X2PC"),l=a("Dsoe"),c=a("3VMZ"),d=a("qhEF"),g=a("8TdO"),p=a("+mzV"),u=a("6wsw"),h=a("Ua4J"),m=a("LjTg"),f=a("Czhu"),b=a("zjfJ"),E=(a("aWzz"),a("6R5o")),I=a.n(E),P=a("nnRT"),y=a.n(P),v=a("L21V"),O=a("IC1n"),S=a.n(O),C=a("u6In"),T=a("XcNc"),j=a("GFmV"),x=a("dIe6"),w=a("MV18"),A=a("6z9Z"),R=a("F4Ur"),D=a("frZf"),k=a("k8LX"),_=a("KIs4"),M=a("+CY+"),L=a("jF39"),N=a("1N1n");const F=(e,t,a,n)=>{const r={type:"sendUIEvent",data:{containerType:"space",containerId:t,objectType:"page",action:e,actionSubject:"pageTree",source:a?"pageTreeDrawer":"containerNavigation",attributes:{navigationLayer:"container"}}};return n&&(r.data.attributes.navdexPointType=n),r};var K=a("6BAR"),U=a("2z5K"),$=a.n(U);const B=e=>e&&e.nodes&&e.nodes.length?e.nodes:[],H=e=>e.map(e=>e.id),V=(e,t,a)=>{const n=e[t];if(!(a&&e&&t&&n))return"VIRTUAL_ROOT_ID";switch(t){case a:return a;case"VIRTUAL_LOCAL_ROOT_ID":return"VIRTUAL_LOCAL_ROOT_ID";default:return V(e,n.parentId,a)}},q=e=>!e.hasChildren||Boolean(e.children)&&e.children.length>0,z=(e,t)=>Object(K.a)(e,a=>{for(const n in t){const r=e[n],s=t[n];if(r){const e=q(s)?s.children:r.children;a[n]=Object(f.a)(Object(f.a)({},s),{},{parentId:r.parentId,children:e})}else a[n]=s}return a}),G=e=>{const{previousSiblings:t,followingSiblings:a,children:n,nearestAncestors:r}=e;return r.nodes.filter(e=>e.previousSiblings.pageInfo.hasNextPage||e.followingSiblings.pageInfo.hasNextPage).length>0||t.pageInfo.hasNextPage||a.pageInfo.hasNextPage||n.pageInfo.hasNextPage},Y=(e,t,a)=>{if(t[e]){const{parentId:n}=t[e];if(n)return a.add(n),Y(n,t,a)}return a},W=(e,t)=>{if(!e)return t;const{previousSiblings:a,followingSiblings:n,nearestAncestors:r,children:s}=e,i={},{endCursor:o}=a.pageInfo;i.previousSiblingsCursor=o||t.previousSiblingsCursor;const{endCursor:l}=n.pageInfo;i.followingSiblingsCursor=l||t.followingSiblingsCursor;const{endCursor:c}=r.pageInfo;i.nearestAncestorsCursor=c||t.nearestAncestorsCursor;const{endCursor:d}=s.pageInfo;i.childrenCursor=d||t.childrenCursor;const g=r.nodes.filter(e=>e.previousSiblings.pageInfo.hasNextPage),p=g.length>0?g[0].previousSiblings.pageInfo.endCursor:null;i.naPreviousSiblingsCursor=p||t.naPreviousSiblingsCursor;const u=r.nodes.filter(e=>e.followingSiblings.pageInfo.hasNextPage),h=u.length>0?u[0].followingSiblings.pageInfo.endCursor:null;return i.naFollowingSiblingsCursor=h||t.naFollowingSiblingsCursor,i};var Q=a("uUTq"),Z=a.n(Q);const X=e=>({id:e.id,children:B(e.children),parentId:null,hasChildren:e.hasChildren,isExpanded:!1,isChildrenLoading:!1,hasRestrictions:e.hasRestrictions||!1,hasInheritedRestrictions:e.hasInheritedRestrictions||!1,data:{title:e.title,webui:e.links.webui}}),J=(e,t={})=>{if(!e)return;const a=B(e.children),n=B(e.nearestAncestors),r=[...B(e.previousSiblings),...B(e.followingSiblings)];return t[e.id]=X(e),r.forEach(e=>J(e,t)),n.forEach(e=>J(e,t)),a.forEach(e=>J(e,t)),t},ee=(e,t={},a=!0)=>{const n=B(e).map(e=>{const a=X(e);return t[e.id]=a,a});return t.VIRTUAL_ROOT_ID={id:"VIRTUAL_ROOT_ID",children:H(n),parentId:null,hasChildren:!0,isExpanded:!0,isChildrenLoading:!1,hasRestrictions:!1,hasInheritedRestrictions:!1,data:{title:"",webui:""}},t.VIRTUAL_LOCAL_ROOT_ID={id:"VIRTUAL_LOCAL_ROOT_ID",children:[],parentId:"VIRTUAL_ROOT_ID",hasChildren:!0,isExpanded:!0,isChildrenLoading:!1,hasRestrictions:!1,hasInheritedRestrictions:!1,data:{title:"",webui:""}},a&&(t=ae(t)),t},te=(e,t)=>{let a={};if(!e)return a;a=J(e,a),a=ee(t,a,!1);const n=B(e.nearestAncestors),r=B(e.children),s=[...[...B(e.previousSiblings)].reverse(),{id:e.id,children:r},...B(e.followingSiblings)];if(n.forEach((e,t)=>{let r=[];if(0===t)r=s;else{const e=n[t-1];r=[...[...B(e.previousSiblings)].reverse(),e,...B(e.followingSiblings)]}a[e.id].children=H(r)}),a[e.id].children=H(r),n.length){const e=n[n.length-1],t=[...[...B(e.previousSiblings)].reverse(),e,...B(e.followingSiblings)];a.VIRTUAL_LOCAL_ROOT_ID.children=H(t)}return a=ae(a),a},ae=e=>Object(K.a)(e,e=>{Object.keys(e).forEach(t=>{const a=e[t];a&&a.children&&a.children.length&&a.children.forEach(t=>{"string"!=typeof t||"VIRTUAL_LOCAL_ROOT_ID"===a.id&&"VIRTUAL_ROOT_ID"===e[t].parentId||(e[t].parentId=a.id)})})}),ne=(e,t,a)=>Object(K.a)(e,e=>{t.forEach(t=>{if(e[t]&&e[t].parentId&&e[t].parentId!==a){const a=e[e[t].parentId];a.children=Z()(a.children,t)}})}),re=Object(v.g)({flagErrorTitle:{id:"page-tree.dragndrop.failed.title",defaultMessage:"Something went wrong"},flagErrorDescription:{id:"page-tree.dragndrop.failed.description",defaultMessage:"Refresh the page and try again. If this keeps happening, contact your space administrator."},flagErrorAction:{id:"page-tree.dragndrop.failed.action.visitsupport",defaultMessage:"Visit Atlassian Support"},flagMovePagePermissionErrorTitle:{id:"page-tree.dragndrop.permissions.error.title",defaultMessage:"This page can’t be moved",description:"Title of error message shown when a page can't be moved due to a permission error"},flagMovePagePermissionErrorDescription:{id:"page-tree.dragndrop.permissions.error.decription",defaultMessage:"You don’t have the right permission to move this restricted page. Contact your space administrator to resolve this.",description:"Description of error message shown when a page can't be moved due to a permission error"},flagUndoTitle:{id:"page-tree.dragndrop.undo.title",defaultMessage:'Moved "{pageTitle}"',description:"The page is moved on the page tree"},flagUndoAction:{id:"page-tree.dragndrop.undo.action",defaultMessage:"Undo",description:"Action to revert drag&drop movement on the page tree"},flagLargePageTreeTitle:{id:"page-tree.dragndrop.lpt.title",defaultMessage:"Too many pages",description:"Message when there are too many pages in the page tree"},flagLargePageTreeDescription:{id:"page-tree.dragndrop.lpt.description",defaultMessage:"You are trying to drag a page while viewing too many pages at once. To reorder, visit your space settings.",description:"Message when there are too many pages in the page tree"},flagLargePageTreeAction:{id:"page-tree.dragndrop.lpt.action",defaultMessage:"Reorder pages",description:"Link to page Reorder Pages within Space settings"},pages:{id:"page-tree.word",defaultMessage:"Pages",description:"title for the side nav page tree section"}});var se=a("H5qd"),ie=a.n(se);const oe=ie.a`mutation MovePageAfterMutation($pageId:ID!$siblingId:ID!){movePageAfter(input:{pageId:$pageId siblingId:$siblingId}){page{id}}}`,le=ie.a`mutation MovePageAppendMutation($pageId:ID!$parentId:ID!){movePageAppend(input:{pageId:$pageId parentId:$parentId}){page{id}}}`,ce=ie.a`mutation MovePageBeforeMutation($pageId:ID!$siblingId:ID!){movePageBefore(input:{pageId:$pageId siblingId:$siblingId}){page{id}}}`;class de{constructor(e=1){Object(b.a)(this,"pop",()=>this.stack.pop()),Object(b.a)(this,"peek",()=>this.stack.slice(-1)[0]),this.size=e,this.stack=[]}push(e,t,a){const n=e[t.parentId],r=n.children[t.index],s=n.children.length>1?t:{parentId:t.parentId};this.stack.push({pageId:r,source:a,destination:s}),this.stack=this.stack.slice(-1*this.size)}}const ge=ie.a`fragment PageInfoFragment on Page{id title hasChildren hasRestrictions hasInheritedRestrictions links{webui}}`,pe=ie.a`query PageTreeChildren($contentId:ID!$first:Int$after:String){page(id:$contentId){...PageInfoFragment children(first:$first after:$after){count nodes{...PageInfoFragment}pageInfo{hasNextPage endCursor}}}}${ge}`;var ue=a("Iy7w"),he=a("lSUb"),me=a("s/6t"),fe=a("zJ/j"),be=a("a8dO"),Ee=a("wORz"),Ie=a("hLvD"),Pe=a("DQJm"),ye=a("lRcl"),ve=a("0Dc1"),Oe=a("XVWa"),Se=a("ltac"),Ce=a("Aqh1"),Te=a("l1C2"),je=a("qcwS"),xe=a("c2NM"),we=a.n(xe),Ae=a("3IV/"),Re=a("PLaw"),De=a.n(Re),ke=a("5ypJ"),_e=a.n(ke),Me=a("NK/E"),Le=a.n(Me),Ne=a("nZDR"),Fe=a.n(Ne),Ke=a("cld1"),Ue=a("3Z2R"),$e=a("MjIW");const Be="com.atlassian.confluence.plugins.confluence-create-content-plugin:header-create-dialog",He=Object(v.g)({label:{id:"contextual-create.label",description:"Label for button that creates pages",defaultMessage:"Create a child page"}}),Ve=Object(v.h)(Object(n.memo)(({intl:e,parentPageId:t,isCreateBlankFabricPageEnabled:a,spaceKey:s})=>{const{setQueryParams:i}=Object(n.useContext)(h.a),o=e=>{let n;e.preventDefault(),e.stopPropagation(),n=a?Object(j.b)(!0,{parentPageId:t,spaceKey:s}):{createDialog:!0,parentPageId:t},i(n),Object(Ke.getAnalyticsWebClient)().then(e=>{e.sendTrackEvent({action:"clicked",actionSubject:"button",source:"contextualCreate"})})},l=e.formatMessage(He.label);return r.a.createElement(Ue.a,{location:$e.a.SYSTEM_HEADER_LEFT_BUTTON_GROUP,allowedWebItems:[Be],fetchPolicy:"cache-first"},({webItems:e})=>{if(!e||!e.length)return null;const t=e.find(e=>e.completeKey===Be);return t?r.a.createElement(be.a,{content:l,key:t.moduleKey,position:"right"},r.a.createElement(fe.a,{appearance:"subtle",iconBefore:r.a.createElement(Fe.a,{size:"small",label:l}),onClick:o})):null})}));var qe=a("0ItC"),ze=a("DQZQ");const Ge=Object(ue.a)("div",{target:"ezvkz0x0"})({name:"1sn8kiq",styles:"display:inline-block;vertical-align:middle;margin-right:5px;"}),Ye=Te.g`
from {
  background: ${Ae.B50};
}
to {
  background: none;
}
`,We=Object(n.memo)(Object(ue.a)("div",{target:"ezvkz0x1"})("width:24px;text-align:center;font-size:12pt;color:",e=>e.itemIsRestricted?Ae.R400:"inherit",";")),Qe=Object(ue.a)("div",{target:"ezvkz0x2"})({name:"5hz1ob",styles:"margin:0 4px;"}),Ze=Object(n.memo)(({isHover:e,isContextualCreateEnabled:t,isCreateBlankFabricPageEnabled:a,isSuperAdmin:n,spaceKey:s,item:i,intl:o})=>{const{hasRestrictions:l,hasInheritedRestrictions:c}=i;return t&&e?r.a.createElement(qe.a,{delay:200,key:"contextual-create"},r.a.createElement(Ve,{parentPageId:i.id,isCreateBlankFabricPageEnabled:a,spaceKey:s})):n&&l&&!c?r.a.createElement(Le.a,{primaryColor:Ae.R400,key:"super-admin",label:o.formatMessage(Je.restrictionsIconLabel)}):null}),Xe=Object(n.memo)(({item:e,isSuperAdmin:t,onExpand:a,onCollapse:n})=>{const{isChildrenLoading:s,hasChildren:i,isExpanded:o,hasRestrictions:l,hasInheritedRestrictions:c}=e,d=(l||c)&&t,g=d?Ae.R400:null;return s?r.a.createElement(Qe,{"data-testid":"tree-item-spinner"},r.a.createElement(ye.a,{size:16})):i?o?r.a.createElement("div",{role:"button",tabIndex:"0",onClick:n,"data-testid":"chevron-down"},r.a.createElement(De.a,{primaryColor:g,label:"",size:"medium"})):r.a.createElement("div",{role:"button",tabIndex:"0",onClick:a,"data-testid":"chevron-right"},r.a.createElement(_e.a,{primaryColor:g,label:"",size:"medium"})):r.a.createElement(We,{itemIsRestricted:d,"data-testid":"dot-icon"},"•")}),Je=Object(v.g)({restrictionsIconLabel:{id:"page-tree.restricted-content.icon",description:"aria-label for the restricted content icon",defaultMessage:"Restricted Content Icon"}}),et=Object(n.memo)(({item:e,spaceHomePageId:t,onExpand:a,onCollapse:s,onHighlight:i,snapshot:o,isSuperAdmin:l,createAnalyticsEvent:c,isInDrawer:d,spaceId:g,onClick:p,isContextualCreateEnabled:u,isCreateBlankFabricPageEnabled:h,spaceKey:m,intl:b})=>{var E,I,P,y;const[v,O]=Object(n.useState)(!1),S=Object(n.useCallback)(()=>{O(!0)},[]),C=Object(n.useCallback)(()=>{O(!1)},[]),T=Object(n.useCallback)(((e,t,a)=>(n,r)=>{var s;const{isSelected:i}=r,{hasRestrictions:o,hasInheritedRestrictions:l}=e,{isDragging:c,draggingOver:d,combineTargetFor:g}=t,p=null!=(s=e)&&null!=(s=s.data)?s.isHighlighted:s,u={height:"40px",padding:"0px 8px",boxSizing:"border-box",display:"flex",margin:"0 !important",backgroundColor:"transparent",alignItems:"center","& [data-item-elem-before]":{marginRight:"4px"},"& > div":{width:"100%"},"&:active":{textDecoration:"none"},"&:visited, &:active":{color:i?Ae.B400:Ae.N500,textDecoration:"none"}};return a&&(o||l)&&(u.color=Ae.R400),c&&(u["&:active"]={boxShadow:Ae.N60A+" 1px 5px 11px 2px",backgroundColor:Ae.N30},u.borderRadius=5,d||(u.color=Ae.N80,u["border-color"]=Ae.N80)),g&&(u.backgroundColor=Ae.N30),p?(u.animation=Ye+" 2s linear",u.outline="none"):u.animation="none",Object(f.a)(Object(f.a)({},n),u)})(e,o,l),[e,o,l]),j=Object(n.useCallback)(t=>{t.preventDefault(),t.stopPropagation(),a(e.id)},[a,e.id]),x=Object(n.useCallback)(t=>{t.preventDefault(),t.stopPropagation(),s(e.id)},[s,e.id]),w=Object(n.useCallback)(t=>{c(F("clicked",g,d,ze.b.START_TOUCH)).fire(),t.metaKey||t.shiftKey||t.altKey||t.ctrlKey||1===t.button||(t.preventDefault(),p(e))},[g,d,p,e,c]),A=(null!=(y=e)&&null!=(y=y.data)?y.title:y)||"",R=null!=(P=e)&&null!=(P=P.data)?P.isHighlighted:P,k=null!=(I=e)&&null!=(I=I.data)?I.isSelected:I,_=`${D.a}${null!=(E=e)&&null!=(E=E.data)?E.webui:E}`;return Object(n.useEffect)(()=>{R&&setTimeout(i,2e3)},[R,i]),r.a.createElement(je.a,{onMouseEnter:S,onMouseLeave:C,href:_,cssFn:T,isSelected:k,iconBefore:r.a.createElement(Xe,{item:e,isSuperAdmin:l,onExpand:j,onCollapse:x}),iconAfter:r.a.createElement(Ze,{isHover:v,isContextualCreateEnabled:u,isCreateBlankFabricPageEnabled:h,isSuperAdmin:l,spaceKey:m,item:e,intl:b}),onClick:w,"data-testid":"page-tree-item"},e.id===t?r.a.createElement("span",{"data-testid":"space-homepage"},r.a.createElement(Ge,{"data-tesid":"homepage-icon"},r.a.createElement(we.a,{label:"",size:"small"})),A):A)}),tt=Object(ue.a)("div",{target:"ebxerkm0"})({name:"1ly8aii",styles:"display:flex;flex-direction:column;flex-grow:1;flex-shrink:0;align-items:flex-start;"});var at=a("B7n+"),nt=a.n(at),rt=a("ewfN");const st=()=>r.a.createElement("svg",{height:"20",width:"21",viewBox:"0 0 21 20",focusable:"false",role:"presentation"},r.a.createElement("g",{fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"},r.a.createElement("path",{d:"M3.5 0C1.84315 0 0.5 1.34315 0.5 3V17C0.5 18.6569 1.84315 20 3.5 20H17.5C19.1569 20 20.5 18.6569 20.5 17V3C20.5 1.34315 19.1569 0 17.5 0H3.5ZM2.5 3C2.5 2.44772 2.94772 2 3.5 2H17.5C18.0523 2 18.5 2.44772 18.5 3V17C18.5 17.5523 18.0523 18 17.5 18H3.5C2.94772 18 2.5 17.5523 2.5 17V3ZM5.5 5C4.94772 5 4.5 5.44772 4.5 6C4.5 6.55228 4.94771 7 5.5 7H15.5C16.0523 7 16.5 6.55228 16.5 6C16.5 5.44772 16.0523 5 15.5 5H5.5ZM4.5 10C4.5 9.44771 4.94772 9 5.5 9H15.5C16.0523 9 16.5 9.44771 16.5 10C16.5 10.5523 16.0523 11 15.5 11H5.5C4.94771 11 4.5 10.5523 4.5 10ZM5.5 13C4.94772 13 4.5 13.4477 4.5 14C4.5 14.5523 4.94772 15 5.5 15H11.5C12.0523 15 12.5 14.5523 12.5 14C12.5 13.4477 12.0523 13 11.5 13H5.5Z"}))),it=(e,t)=>{const{isSelected:a}=t,n={marginTop:"9px",backgroundColor:"inherit","&:active, &:focus":{textDecoration:"none"},"&:visited, &:active":{color:a?Ae.B400:Ae.N500,textDecoration:"none"}};return Object(f.a)(Object(f.a)({},e),n)},ot=()=>{const{location:e}=Object(n.useContext)(h.a),{spaceKey:t}=Object(n.useContext)(p.a);return r.a.createElement(je.a,{cssFn:it,iconBefore:r.a.createElement(nt.a,{label:"",glyph:st}),href:rt.SPACE_PAGES.toUrl({spaceKey:t}),isSelected:Boolean(rt.SPACE_PAGES.match((null==e?void 0:e.pathname)||""))},r.a.createElement(v.c,Object(f.a)({},re.pages)))};const lt=Object(ue.a)("div",{target:"e1o8qdqg0"})({name:"wes3ci",styles:"margin-left:14px;"}),ct=Object(ue.a)("div",{target:"e1o8qdqg1"})({name:"14yaxqh",styles:"flex-grow:1;flex-shrink:0;width:100%;display:flex;> div{flex-grow:1;width:100%;}"}),dt=Object(ue.a)(Ie.a,{target:"e1o8qdqg2"})({name:"g10pjn",styles:"overflow:hidden;min-width:0;width:100%;"}),gt=Object(ue.a)("div",{target:"e1o8qdqg3"})({name:"1uty0ys",styles:"margin:10px 0 10px 0;width:100%;"}),pt=Object(ue.a)("div",{target:"e1o8qdqg4"})({name:"zvice1",styles:"display:flex;flex-wrap:nowrap;justify-content:space-between;"}),ut=Object(ue.a)("div",{target:"e1o8qdqg5"})({name:"1l4w6pd",styles:"display:flex;justify-content:center;"}),ht=Object(v.h)(Object(C.a)()(class extends n.PureComponent{constructor(...e){super(...e),Object(b.a)(this,"scrolledItemId",null),Object(b.a)(this,"highlightedPages",[]),Object(b.a)(this,"collapsePage",e=>{const{isInDrawer:t,tree:a,createAnalyticsEvent:n}=this.props;n(F("collapsed",this.props.spaceId,t)).fire(),this.props.onCollapse(a.items[e])}),Object(b.a)(this,"expandPage",e=>{const{isInDrawer:t,tree:a,createAnalyticsEvent:n}=this.props;n(F("expanded",this.props.spaceId,t)).fire(),this.props.onExpand(a.items[e])}),Object(b.a)(this,"dragStart",async e=>{const{onDragStart:t,createAnalyticsEvent:a}=this.props;t(e),a({type:"sendUIEvent",data:{action:"dragged",actionSubject:"pageTree",source:"viewPageScreen"}}).fire()}),Object(b.a)(this,"dragEnd",async(e,t)=>{const{onDragEnd:a,createAnalyticsEvent:n}=this.props;var r;a(e,t),n((r=!!t,{type:"sendUIEvent",data:{action:"dropped",actionSubject:"pageTree",source:"viewPageScreen",attributes:{isValidTarget:r}}})).fire()}),Object(b.a)(this,"patchInnerRef",(e,t)=>e.data.isSelected||e.data.isHighlighted?a=>{t.innerRef(a),setTimeout(()=>this.scrollToItem(e,a),0)}:t.innerRef),Object(b.a)(this,"getHighlightedPages",Object(he.a)(e=>{const t=[];if(e)for(const a in e)e.hasOwnProperty(a)&&e[a].data&&e[a].data.isHighlighted&&t.push(e[a].id);return t},y.a)),Object(b.a)(this,"onPageHighlighted",e=>{this.highlightedPages.push(e);const t=this.getHighlightedPages(this.props.tree.items);this.highlightedPages.length===t.length&&(this.props.onPagesHighlighted(this.highlightedPages),this.highlightedPages=[])}),Object(b.a)(this,"renderItem",Object(he.a)(({item:e,onExpand:t,onCollapse:a,provided:n,snapshot:s})=>{const i=this.patchInnerRef(e,n),{isSuperAdmin:o,spaceHomePageId:l,isInDrawer:c,createAnalyticsEvent:d,onClick:g,isCreateBlankFabricPageEnabled:p,spaceKey:u,isContextualCreateEnabled:h}=this.props,m=e.data?e.data.title:"",b=r.a.createElement("div",Object(f.a)(Object(f.a)({className:"item","data-test-id":"page-tree-item",ref:i},n.draggableProps),n.dragHandleProps),r.a.createElement(be.a,{content:m,position:"top",delay:750,hideTooltipOnMouseDown:!0},r.a.createElement(et,{item:e,spaceHomePageId:l,onExpand:t,onCollapse:a,onHighlight:()=>this.onPageHighlighted(e.id),snapshot:s,isSuperAdmin:o,isInDrawer:c,createAnalyticsEvent:d,onClick:g,isContextualCreateEnabled:h,isCreateBlankFabricPageEnabled:p,spaceKey:u,intl:this.props.intl})));return e.data.isSelected?this.addSpotlight(b):b}))}scrollToItem(e,t){if(this.props.scrollToCurrent&&e.data.isSelected&&t)return Object(Se.g)(t),void this.props.onScrollTo();this.scrolledItemId!==e.id&&Object(Se.g)(t),this.scrolledItemId=e.id}addSpotlight(e){return r.a.createElement(Ee.a,{name:"page-tree-spotlight"},e)}render(){const{tree:e,loadMorePages:t,isTreeTruncated:a,isDraggable:s,spaceKey:i,currentPageId:o,spaceHomePageId:l,isPagesItemEnabled:d,loading:g}=this.props,p=a?r.a.createElement(gt,null,r.a.createElement(fe.a,{shouldFitContainer:!0,onClick:t},r.a.createElement(v.c,{id:"page-tree.pages.show.all",defaultMessage:"Show all pages"}))):null,u=d?r.a.createElement(ot,null):r.a.createElement(Pe.a,{"aria-hidden":"true",style:o===l?{padding:"5px 10px",marginTop:"9px",marginBottom:"1px"}:{}},r.a.createElement(pt,null,r.a.createElement(v.c,Object(f.a)({},re.pages)))),h=d?lt:n.Fragment,m=r.a.createElement(dt,null,g||Object.keys(e.items).length>0?o===l?this.addSpotlight(u):u:null,g?r.a.createElement(ut,null,r.a.createElement(ye.a,{size:"medium",testId:"page-tree-loading"})):r.a.createElement(n.Fragment,null,p,r.a.createElement(h,null,r.a.createElement(ct,null,r.a.createElement(me.a,{tree:e,isDragEnabled:s,renderItem:this.renderItem,onExpand:this.expandPage,onCollapse:this.collapsePage,onDragStart:this.dragStart,onDragEnd:this.dragEnd,offsetPerLevel:24,isNestingEnabled:!0}),r.a.createElement(Ce.a.Consumer,null,({isNav2:e})=>r.a.createElement(n.Fragment,null,r.a.createElement(ve.a,{subject:Oe.a.navigation,subjectId:"NavigationLoading",details:{navigationView:"container",view:"space",navVersion:e?2:3,spaceKey:i}}),r.a.createElement(ve.a,{subject:Oe.a.navigationView,subjectId:"SpaceViewLoading",details:{navigationView:"container",view:"space",navVersion:e?2:3,spaceKey:i}}))),r.a.createElement(w.a,{name:c.a.PAGE_TREE}))),p));return r.a.createElement(tt,null,m)}}));var mt=a("1whV"),ft=a.n(mt);const bt=Object(ue.a)("div",{target:"eyspfzh0"})({name:"lfws4q",styles:"padding:8px 0px 8px 8px;box-sizing:border-box;height:40px;width:fit-content;"}),Et=Object(ue.a)("span",{target:"eyspfzh1"})({name:"1lvfsfo",styles:"padding-left:4px;padding-right:7px;line-height:24px;cursor:default;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:#42526e;"}),It=Object(ue.a)("div",{target:"eyspfzh2"})({name:"k008qs",styles:"display:flex;"}),Pt=Object(v.g)({pages:{id:"page-tree.word",defaultMessage:"Pages"},failedLoadTooltip:{id:"page-tree.failed.load.tooltip",defaultMessage:"Hold tight, we’re working on fixing this."},failedLoadContent:{id:"page-tree.failed.load.content",defaultMessage:"Page tree failed to load"}}),yt=Object(n.memo)(({intl:e})=>r.a.createElement(n.Fragment,null,r.a.createElement(Ie.a,{title:e.formatMessage(Pt.pages)},r.a.createElement(bt,null,r.a.createElement(be.a,{content:e.formatMessage(Pt.failedLoadTooltip),position:"bottom"},r.a.createElement(It,null,r.a.createElement(ft.a,{label:"error",primaryColor:"rgb(191, 38, 0)"}),r.a.createElement(Et,null,e.formatMessage(Pt.failedLoadContent))))))));yt.displayName="PageTreeErrorComponent",yt.propTypes={intl:v.i};const vt=Object(v.h)(yt),Ot=ie.a`fragment PageListFragment on PaginatedPageList{count nodes{...PageInfoFragment}pageInfo{hasNextPage endCursor}}`,St=ie.a`fragment PageInfoFragment on Page{id title hasChildren hasRestrictions hasInheritedRestrictions links{webui}}`,Ct=ie.a`query PageTree($spaceKey:String!$contentId:ID!$paginationLimit:Int$nearestAncestorCursor:String$naPreviousSiblingsCursor:String$naFollowingSiblingsCursor:String$previousSiblingsCursor:String$followingSiblingsCursor:String$childrenCursor:String){currentPage:page(id:$contentId pageTree:$paginationLimit enablePaging:true){...PageInfoFragment nearestAncestors(after:$nearestAncestorCursor){count pageInfo{hasNextPage endCursor}nodes{...PageInfoFragment previousSiblings(after:$naPreviousSiblingsCursor){...PageListFragment}followingSiblings(after:$naFollowingSiblingsCursor){...PageListFragment}}}previousSiblings(after:$previousSiblingsCursor){...PageListFragment}followingSiblings(after:$followingSiblingsCursor){...PageListFragment}children(after:$childrenCursor){...PageListFragment}}rootLevelPages:pages(spaceKey:$spaceKey){nodes{...PageInfoFragment}}space(key:$spaceKey){id homepage{id}operations{operation targetType}}}${St}${Ot}`,Tt=ie.a`query PageTreeRootLevelPages($spaceKey:String!){rootLevelPages:pages(spaceKey:$spaceKey){nodes{id hasChildren title hasRestrictions hasInheritedRestrictions links{webui}}}space(key:$spaceKey){id homepage{id}operations{operation targetType}}}`;class jt extends n.Component{constructor(...e){super(...e),Object(b.a)(this,"state",{expandedPages:new Set,loadingPages:new Set,pages:{},space:null,spaceKey:null,rootId:null,initialLoading:!0,loadingMorePages:!1,isTreeTruncated:!1,initialCursors:null,initialPages:null,error:null,blogPeekRoot:void 0}),Object(b.a)(this,"querySubscription",null),Object(b.a)(this,"pageMoveHistory",new de),Object(b.a)(this,"getFocusedPageId",()=>this.state.blogPeekRoot||this.props.currentPageId||this.props.highlightPages[0]),Object(b.a)(this,"queryChildren",(e,t,a={count:0,nodes:[]},n=!1)=>this.props.apolloClient.query({query:pe,fetchPolicy:n?"network-only":"cache-first",variables:{contentId:e,first:100,after:t}}).then(t=>{const{children:r}=t.data.page,s=((e,t)=>({count:e.count+t.count,nodes:[...e.nodes,...t.nodes]}))(a,r);return r.pageInfo.hasNextPage?this.queryChildren(e,r.pageInfo.endCursor,s,n):s})),Object(b.a)(this,"reloadChildren",()=>{this.queryChildren(this.getFocusedPageId(),void 0,void 0,!0)}),Object(b.a)(this,"getPageQueryObservable",(e,t,a=!1)=>{const n=e?Ct:Tt,r=e?{contentId:e,spaceKey:t}:{spaceKey:t},s=Object(f.a)({paginationLimit:500},r);return this.props.apolloClient.watchQuery({fetchPolicy:"cache-and-network",query:n,variables:!0===a?s:r})}),Object(b.a)(this,"loadPages",async(e=!1)=>{const{pages:t}=this.state,{spaceKey:a,isPeekingFromBlogs:n}=this.props,r=this.getFocusedPageId(),s=n&&void 0===this.state.blogPeekRoot,i=this.getPageQueryObservable(r,a,e);this.querySubscription=i.subscribe({next:({data:e,loading:r})=>{if(r&&!e&&this.setState({initialLoading:!0}),e&&Object.keys(e).length>0){const{currentPage:r,rootLevelPages:i,space:o}=e,l=r?te(r,i):ee(i),c=W(r,{}),d=z(t,l),g=r?r.id:null,p=o.homepage?o.homepage.id:null,u={expandedPages:this.determineInitiallyExpandedPages(l),rootId:V(d,g,p),pages:d,space:o,spaceKey:a,isTreeTruncated:!!r&&G(r),initialCursors:c,initialPages:r};n&&(u.blogPeekRoot=o.homepage&&o.homepage.id||"noHomepageFound"),this.setState(u),s&&"noHomepageFound"!==u.blogPeekRoot&&(this.querySubscription.unsubscribe(),this.loadPages())}r||this.setState({initialLoading:!1})},error:e=>this.handleLoadingError(e,c.a.PAGE_TREE)})}),Object(b.a)(this,"loadMorePages",async()=>{const{spaceKey:e,createAnalyticsEvent:t}=this.props,a=this.getFocusedPageId();t({type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:"showAllButton",source:"containerNavigation"}}).fire(),this.setState({loadingMorePages:!0});const{initialCursors:n,initialPages:r}=this.state,{mergedPages:s,rootLevelPages:i}=await this.loadAllPages(a,e,n,r),o=te(s,i);this.setState({spaceKey:e,pages:o,isTreeTruncated:!1,loadingMorePages:!1})}),Object(b.a)(this,"loadAllPages",(e,t,a,n)=>{const r=Ct,s=Object(f.a)({contentId:e,spaceKey:t},a);return this.props.apolloClient.query({query:r,variables:s}).then(r=>{const{data:s,error:i}=r;if(i)this.handleLoadingError(i);else if(s&&Object.keys(s).length>0){const{currentPage:r,rootLevelPages:i}=s,o=((e,t)=>t?Object(K.a)(t,t=>{const{previousSiblings:a,followingSiblings:n,nearestAncestors:r,children:s}=e,{previousSiblings:i,followingSiblings:o,nearestAncestors:l,children:c}=t;i.nodes=$()(i.nodes,a.nodes,"id"),o.nodes=$()(o.nodes,n.nodes,"id"),c.nodes=$()(c.nodes,s.nodes,"id");const d=$()(r.nodes,l.nodes,"id");return l.nodes.forEach(e=>{const t=d.filter(t=>t.id===e.id);if(t.length>0){const{previousSiblings:a,followingSiblings:n}=t[0];a.nodes=$()(e.previousSiblings.nodes,a.nodes,"id"),n.nodes=$()(e.followingSiblings.nodes,n.nodes,"id")}}),l.nodes=d,i.pageInfo.hasNextPage=i.pageInfo.hasNextPage&&a.pageInfo.hasNextPage,o.pageInfo.hasNextPage=o.pageInfo.hasNextPage&&n.pageInfo.hasNextPage,l.pageInfo.hasNextPage=l.pageInfo.hasNextPage&&r.pageInfo.hasNextPage,t}):e)(r,n);if(G(r)){const n=W(r,a);return this.loadAllPages(e,t,n,o)}return{mergedPages:o,rootLevelPages:i}}})}),Object(b.a)(this,"determineInitiallyExpandedPages",e=>{const{expandedPages:t}=this.state;for(const a in e){const n=e[a];n.hasChildren&&q(n)&&t.add(n.id)}return t}),Object(b.a)(this,"expandPage",async e=>{const{expandedPages:t}=this.state;if(!t.has(e.id)&&e.hasChildren){const{pages:t,expandedPages:a,loadingPages:n}=this.state,r=t[e.id],s=[e.id,...Y(e.id,t,a)];if(!q(r)){this.setState({loadingPages:n.add(r.id)});const e={},a=B(await this.queryChildren(r.id));a.forEach(t=>{e[t.id]=X(t)});const s=z(t,e);n.delete(r.id);const i=((e,t,a)=>Object(K.a)(e,e=>{e[t].children=a;const n=ne(e,a,t);ae(n)}))(s,r.id,H(a));this.setState({loadingPages:n,pages:i})}this.setState({expandedPages:new Set(s)})}}),Object(b.a)(this,"collapsePage",e=>{const{expandedPages:t}=this.state;t.delete(e.id),this.setState({expandedPages:t})}),Object(b.a)(this,"visitPage",e=>{const{push:t,onItemClick:a}=this.props;t(`${D.a}${e.data.webui}`),a&&a()}),Object(b.a)(this,"determineMutation",e=>void 0===e.index?le:0===e.index?ce:oe),Object(b.a)(this,"determineMutationVariables",(e,t,a)=>{if(void 0===a.index)return{pageId:t,parentId:a.parentId};const n=0===a.index,r=e[a.parentId].children.indexOf(t),s=r>-1&&r<a.index,i=n||s?a.index:a.index-1;return{pageId:t,siblingId:e[a.parentId].children[i]}}),Object(b.a)(this,"movePage",async(e,t)=>{const{pages:a}=this.state;if(!this.isValidMove(e,t))return void this.props.experienceTracker.abort({name:c.a.PAGE_TREE_DND,reason:"Invalid drop location"});const n=a[e.parentId].children[e.index];this.movePageInState(n,e,t),this.pageMoveHistory.push(a,e,t),await this.requestPageMove(a,n,e.parentId,t,!0)}),Object(b.a)(this,"undo",async()=>{const{flags:e}=this.props,{pages:t}=this.state,a=this.pageMoveHistory.pop();if(a){const{pageId:n,source:r,destination:s,flagId:i}=a;if(this.movePageInState(n,r,s,!0),void 0!==i)return e.hideFlag(i),this.requestPageMove(t,n,r.parentId,s,!1)}}),Object(b.a)(this,"handleGenericError",({apolloError:e,lastAction:t,experience:a})=>{if(!e)return;if(Object(k.c)(e))return Object(R.a)(e),void this.setState({error:{apolloError:e,lastAction:t,isExpected:!0}});const{flags:n,intl:r,experienceTracker:s}=this.props;(({graphQLErrors:e})=>{if(!e||!e.length)return!1;for(const{extensions:t,path:a}of e)if(Array.isArray(a)&&a.some(e=>e.includes("movePage"))&&t&&t.http&&403===t.http.status)return!0;return!1})(e)?n.showErrorFlag({title:r.formatMessage(re.flagMovePagePermissionErrorTitle),description:r.formatMessage(re.flagMovePagePermissionErrorDescription)}):n.showErrorFlag({title:r.formatMessage(re.flagErrorTitle),description:r.formatMessage(re.flagErrorDescription)}),this.setState({error:{apolloError:e,lastAction:t}}),s.stopOnError({name:a,error:e})}),Object(b.a)(this,"handleLoadingError",(e,t)=>this.handleGenericError({apolloError:e,lastAction:"LOAD",experience:t})),Object(b.a)(this,"handleDragDropSuccess",(e,t,a,n)=>()=>{const{createAnalyticsEvent:r,onDragDropSuccess:s,experienceTracker:i}=this.props,{space:o}=this.state;r((({spaceId:e,pageId:t,previousParentPageId:a,newParentPageId:n})=>({type:"sendTrackEvent",data:{action:"updated",source:"viewPageScreen",containerType:"space",containerId:e,objectType:"page",objectId:t,actionSubject:"page",attributes:{previousSpaceId:e,previousParentPageId:a,newSpaceId:e,newParentPageId:n}}}))({spaceId:o.id,pageId:e,previousParentPageId:t,newParentPageId:a})).fire(),i.succeed({name:c.a.PAGE_TREE_DND}),s(e);const l=this.pageMoveHistory.peek();if(n&&l){const t=this.showUndoFlag(e);l.flagId=t}}),Object(b.a)(this,"handleDragDropError",e=>this.handleGenericError({apolloError:e,lastAction:"DND",experience:c.a.PAGE_TREE_DND})),Object(b.a)(this,"canMovePages",(e,t)=>!!e&&e.operations&&!!I()(e.operations,{targetType:"page",operation:"create"})&&!t),Object(b.a)(this,"showUndoFlag",e=>{const{flags:t,intl:a}=this.props,{pages:n}=this.state,r=S()();return t.showSuccessFlag({id:r,title:a.formatMessage(re.flagUndoTitle,{pageTitle:n[e].data.title}),actions:[{content:a.formatMessage(re.flagUndoAction),onClick:this.onUndoFlagClick}]}),r}),Object(b.a)(this,"onDragStart",()=>{const{pages:e}=this.state,{experienceTracker:t}=this.props;t.start({name:c.a.PAGE_TREE_DND}),Object.keys(e).length>500&&(window.dispatchEvent(new Event("scroll")),this.showLargePageTreeFlag(),t.abort({name:c.a.PAGE_TREE_DND,reason:"Large page tree limit exceeded"})),this.hideLastFlag()}),Object(b.a)(this,"onUndoFlagClick",()=>{const{createAnalyticsEvent:e}=this.props;e({type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:"pageTreeDragDropUndo",source:"viewPageScreen"}}).fire(),this.undo()}),Object(b.a)(this,"onUndoShortCut",()=>{const{createAnalyticsEvent:e}=this.props;e({type:"sendUIEvent",data:{action:"pressed",actionSubject:"keyboardShortcut",actionSubjectId:"pageTreeDragDropUndo",source:"viewPageScreen"}}).fire(),this.undo()}),Object(b.a)(this,"hideLastFlag",()=>{const{flags:e}=this.props,t=this.pageMoveHistory.peek();t&&e.hideFlag(t.flagId)}),Object(b.a)(this,"showLargePageTreeFlag",()=>{const{flags:e,intl:t,spaceKey:a,push:n}=this.props;return e.showWarningFlag({title:t.formatMessage(re.flagLargePageTreeTitle),description:t.formatMessage(re.flagLargePageTreeDescription),actions:[{content:t.formatMessage(re.flagLargePageTreeAction),onClick:()=>{n("/wiki/pages/reorderpages.action?key="+a)}}]})})}static getDerivedStateFromProps(e,t){const{currentPageId:a,highlightPages:n}=e,{expandedPages:r,loadingPages:s,pages:i}=t,o=((e,t,a,n,r)=>Object(K.a)(e,e=>{for(const s in e)if(e.hasOwnProperty(s)){const i=e[s];i.isExpanded=a.has(s),i.isChildrenLoading=n.has(s),i.data.isSelected=i.id===t,i.data.isHighlighted=r.includes(i.id)}}))(i,a,r,s,n);return Object(f.a)(Object(f.a)({},t),{},{pages:o})}componentDidMount(){this.loadPages(!0)}componentDidUpdate(e){const{currentPageId:t,spaceKey:a,highlightPages:n,forceFetchCurrentPage:r,forceFetchedCallback:s}=this.props,{pages:i,spaceKey:o}=this.state;let l=!1;if(t&&(r||e.currentPageId!==t)){const e=i[t];!e||r||a!==o?(l=!0,this.loadPages(!0).then(()=>{r&&s()})):this.expandPage(e)}if(n.length&&!y()(e.highlightPages,n)){const e=i[n[0]];e||l?e&&this.expandPage(e):this.loadPages(!0)}}componentWillUnmount(){this.querySubscription&&this.querySubscription.unsubscribe()}requestPageMove(e,t,a,n,r){const{apolloClient:s}=this.props,i=this.determineMutation(n),o=this.determineMutationVariables(e,t,n);return s.mutate({mutation:i,variables:o}).then(this.handleDragDropSuccess(t,a,n.parentId,r)).catch(this.handleDragDropError)}movePageInState(e,t,a,n){const{rootId:r,pages:s,expandedPages:i}=this.state;let o={rootId:r,items:s};if(void 0===t.index){const n=s[t.parentId],r=n.children.indexOf(e);if(-1!==r){const e=[...n.children];e.splice(r,1)[0],o=Object(T.d)(o,t.parentId,{children:e,hasChildren:e.length>0,isExpanded:e.length>0&&n.isExpanded})}const i=[...o.items[a.parentId].children];i.splice(a.index,0,e),o=Object(T.d)(o,a.parentId,{children:i,hasChildren:!0})}else o=Object(T.c)(o,t,a);0===o.items[t.parentId].children.length&&i.delete(t.parentId),n&&i.add(a.parentId),this.setState({pages:o.items,rootId:o.rootId,expandedPages:i})}isValidMove(e,t){const{pages:a}=this.state;return t&&!y()(e,t)&&Object.keys(a).length<500}render(){const{pages:e,rootId:t,space:a,initialLoading:s,loadingMorePages:i,isTreeTruncated:o,error:l}=this.state;if(l&&"LOAD"===l.lastAction)return r.a.createElement(n.Fragment,null,r.a.createElement(vt,{error:l}),l.isExpected?r.a.createElement(w.a,{name:c.a.PAGE_TREE}):r.a.createElement(x.a,{error:l.apolloError}));const{isDraggable:d,isInDrawer:g,isSuperAdmin:p,spaceKey:u,apolloClient:h,onPagesHighlighted:m,scrollToCurrent:f,onScrollTo:b}=this.props,E=d&&this.canMovePages(a,l);return r.a.createElement(_.a,null,({featureFlags:c,featureFlagClient:d})=>{var I;const P=c["confluence.frontend.contextual-create"];return r.a.createElement(n.Fragment,null,l&&r.a.createElement(x.a,{error:l.apolloError}),r.a.createElement(M.a,{accelerator:"mod+z",listener:this.onUndoShortCut}),r.a.createElement(ht,{isSuperAdmin:p,currentPageId:this.getFocusedPageId(),isDraggable:E,isTreeTruncated:o,isInDrawer:g,loadMorePages:this.loadMorePages,onClick:this.visitPage,onCollapse:this.collapsePage,onDragStart:this.onDragStart,onDragEnd:this.movePage,onExpand:this.expandPage,spaceHomePageId:(null!=(I=a)&&null!=(I=I.homepage)?I.id:I)||null,spaceId:a&&a.id,spaceKey:u,tree:{rootId:t,items:e},isContextualCreateEnabled:P,isCreateBlankFabricPageEnabled:Object(j.d)(d),apolloClient:h,onPagesHighlighted:m,scrollToCurrent:f,onScrollTo:b,isPagesItemEnabled:c["confluence.frontend.space.pages"],loading:i||s}),r.a.createElement(L.a,{name:"pagetree",types:[N.e.content],reload:this.reloadChildren}))})}}Object(b.a)(jt,"defaultProps",{isDraggable:!0,highlightPages:[],forceFetchCurrentPage:!1});const xt=Object(A.b)(Object(v.h)(Object(C.a)()(jt)));a.d(t,"PageTree",(function(){return At}));const wt=()=>{},At=Object(n.memo)(({isInDrawer:e=!1,onDragDropSuccess:t=wt,onItemClick:a,isPeekingFromBlogs:f})=>{const{push:b}=Object(n.useContext)(h.a),{spaceKey:E,contentId:I,contentIdLoading:P}=Object(n.useContext)(p.a);return r.a.createElement(i.a,{attribution:o.a.DISCO},r.a.createElement(s.c,{to:[d.a]},i=>r.a.createElement(s.c,{to:[u.a]},s=>{const o=Boolean(I)||!P,d=()=>s.clearHighlightedPages(),p=()=>s.clearForceFetch(),u=()=>s.clearScrollTo(),h=f?null:s.state.forceFetchPageId||I;return o?r.a.createElement(m.a,null,({isSuperAdmin:o})=>r.a.createElement(n.Fragment,null,r.a.createElement(l.a,{name:c.a.PAGE_TREE,id:E}),r.a.createElement(xt,{key:E,isSuperAdmin:o,isPeekingFromBlogs:f,apolloClient:Object(g.getApolloClient)(),push:b,onItemClick:a,onDragDropSuccess:t,currentPageId:h,scrollToCurrent:s.state.scrollToCurrent,onScrollTo:u,highlightPages:s.state.highlightPagesIds,onPagesHighlighted:d,forceFetchCurrentPage:Boolean(s.state.forceFetchPageId),forceFetchedCallback:p,spaceKey:E,flags:i,isInDrawer:e}))):null})))});At.displayName="PageTree"},LjTg:function(e,t,a){"use strict";a("aWzz");var n=a("ERkP"),r=a.n(n),s=a("gQ5V"),i=a("wKA4"),o=a("H5qd");const l=a.n(o).a`query IsSuperAdmin{user(current:true){id confluence{roles{isSuperAdmin}}}}`;a.d(t,"a",(function(){return c}));const c=({children:e})=>Object(i.a)()?r.a.createElement(s.b,{query:l},({loading:t,error:a,data:n})=>{var r;return e({loading:t,error:a,isSuperAdmin:Boolean(null!=(r=n)&&null!=(r=r.user)&&null!=(r=r.confluence)&&null!=(r=r.roles)?r.isSuperAdmin:r)})}):e({loading:!1,isSuperAdmin:!1})},MjIW:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={TOOLS_MENU_CONTAINER:"system.content.action",TOOLS_MENU_MARKER:"system.content.action/marker",TOOLS_MENU_LEADING:"system.content.action/leading",TOOLS_MENU_PRIMARY:"system.content.action/primary",TOOLS_MENU_SECONDARY:"system.content.action/secondary",TOOLS_MENU_MODIFY:"system.content.action/modify",PAGE_BUTTONS:"system.content.button",SYSTEM_DASHBOARD:"system.dashboard",SYSTEM_DASHBOARD_BUTTON:"system.dashboard.button",SYSTEM_CONTENT_BYLINE:"system.content.byline",SYSTEM_CONTENT_METADATA:"system.content.metadata",PAGE_METADATA_BANNER:"page.metadata.banner",SYSTEM_HEADER_LEFT:"system.header/left",SYSTEM_HEADER_LEFT_BUTTON_GROUP:"system.header/left.button.group",SYSTEM_HELP:"system.help/pages",SYSTEM_USER_ANONYMOUS:"system.user/anonymous",SYSTEM_USER:"system.user",SYSTEM_ADMIN_SITE_SECTION:"system.admin.site/site_admin_section",SPACE_SIDEBAR:"system.space.sidebar/main-links",SYSTEM_ADMIN:"system.admin",SYSTEM_EDITOR_LINK_BROWSER_TABS:"system.editor.link.browser.tabs",SYSTEM_EDITOR_PRECURSOR_BUTTONS:"system.editor.precursor.buttons",CREATE_DIALOG:"system.create.dialog/content",ACTION_PANEL:"page.view.selection/action-panel",DASHBOARD_LEFT:"atl.dashboard.left",DASHBOARD_SECONDARY:"atl.dashboard.secondary",ATL_GENERAL:"atl.general",ATL_FOOTER:"atl.footer",ATL_PAGE_METADATA:"atl.page.metadata.banner",ATL_PAGE_CONTENT_FOOTER_ACTIONS:"atl.page.content.footer.actions",ATL_EDITOR_SAVEBAR:"atl.editor.savebar",SYSTEM_ADMIN_SITE_ADMINISTRATION:"system.admin/siteadministration",SYSTEM_ADMIN_SITE_ADMINISTRATION_SECURITY:"system.admin/security"}},"NK/E":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(a("ERkP")),r=s(a("4KTy"));function s(e){return e&&e.__esModule?e:{default:e}}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var o=function(e){return n.default.createElement(r.default,i({dangerouslySetGlyph:'<svg width="24" height="24" viewBox="0 0 24 24" focusable="false" role="presentation"><path fill="currentColor" fill-rule="evenodd" d="M8 10V8.002A4.004 4.004 0 0 1 12 4a4 4 0 0 1 4 4.002V10a2 2 0 0 1 2 2v6c0 1.105-.902 2-2.009 2H8.01A2 2 0 0 1 6 18v-6c0-1.102.897-1.995 2-2zm2 0h4V8.002A2.001 2.001 0 0 0 12 6c-1.102 0-2 .898-2 2.002V10zm2 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></svg>'},e))};o.displayName="LockFilledIcon";var l=o;t.default=l},ViWs:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));let n;!function(e){e.NOT_ENROLLED="not-enrolled",e.IN_EDITOR_TEMPLATES_EXPERIENCE="in-editor-templates-experience",e.DEFAULT_TEMPLATES_EXPERIENCE="default-templates-experience"}(n||(n={}));const r=e=>e.getVariantValue("confluence.frontend.in-editor-templates.phase-1",{default:n.NOT_ENROLLED,oneOf:Object.values(n),shouldTrackExposureEvent:!0})===n.IN_EDITOR_TEMPLATES_EXPERIENCE},"X+YX":function(e,t,a){var n=a("JBn+"),r=a("OfKG"),s=a("sCL+"),i=a("H87J"),o=a("SU8Q"),l=a("S0iI");e.exports=function(e,t,a,c){var d=-1,g=r,p=!0,u=e.length,h=[],m=t.length;if(!u)return h;a&&(t=i(t,o(a))),c?(g=s,p=!1):t.length>=200&&(g=l,p=!1,t=new n(t));e:for(;++d<u;){var f=e[d],b=null==a?f:a(f);if(f=c||0!==f?f:0,p&&b==b){for(var E=m;E--;)if(t[E]===b)continue e;h.push(f)}else g(t,b,c)||h.push(f)}return h}},bWlm:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("ERkP"),r=a("+6Tk"),s=a("1N1n");const i=e=>{const t=Object(r.a)(s.a),{contentId:a,registerReloader:i}=Object(n.useContext)(s.b);Object(n.useEffect)(()=>{t&&i(e)},[a,e.reload,e.name,t])}},c2NM:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(a("ERkP")),r=s(a("4KTy"));function s(e){return e&&e.__esModule?e:{default:e}}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var o=function(e){return n.default.createElement(r.default,i({dangerouslySetGlyph:'<svg width="24" height="24" viewBox="0 0 24 24" focusable="false" role="presentation"><path d="M10 19v-4.5a2 2 0 1 1 4 0V19h4a1 1 0 0 0 1-1v-7.831l-6.293-6.296a1 1 0 0 0-1.414 0L5 10.169V18a1 1 0 0 0 1 1h4zm11-6.83V18a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3v-5.83l-.04.04c-.39.39-1.03.39-1.42 0-.39-.39-.39-1.03 0-1.42l8.339-8.331a3 3 0 0 1 4.242 0l8.339 8.331c.39.39.39 1.03 0 1.42-.39.39-1.03.39-1.42 0l-.04-.04z" fill="currentColor"/></svg>'},e))};o.displayName="HomeIcon";var l=o;t.default=l},jF39:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("bWlm");const r=e=>(Object(n.a)(e),null)},jLkM:function(e,t,a){var n=a("s+R0");e.exports=function(e){return e&&e.length?n(e):[]}},uUTq:function(e,t,a){var n=a("X+YX"),r=a("R3TX"),s=a("Ndl3"),i=r((function(e,t){return s(e)?n(e,t):[]}));e.exports=i},yjkv:function(e,t,a){var n=a("S3pA"),r=a("s+R0");e.exports=function(e,t){return e&&e.length?r(e,n(t,2)):[]}}}]);
//# sourceMappingURL=page-tree~b59ad437.99BNkDiY96.js.map