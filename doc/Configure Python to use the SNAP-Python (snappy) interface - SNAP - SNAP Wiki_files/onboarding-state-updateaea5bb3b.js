(window.webpackJsonp=window.webpackJsonp||[]).push([["onboarding-state-update~aea5bb3b"],{"29F/":function(e,t,a){"use strict";a.d(t,"f",(function(){return c})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"e",(function(){return o})),a.d(t,"g",(function(){return l})),a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return s})),a.d(t,"h",(function(){return d})),a.d(t,"i",(function(){return E}));var n=a("Qdol");const c={IS_PANEL_OPEN:"quickstart-state:isPanelOpen",IS_DISMISSED:"quickstart-state:isDismissed",OPEN_TASK_ID:"quickstart-state:openTaskId",CREATE_SPACE_COMPLETED:"quickstart-state:createSpaceCompleted",CREATE_PAGE_COMPLETED:"quickstart-state:createPageCompleted",INVITE_TEAMMATE_COMPLETED:"quickstart-state:inviteTeammateCompleted",SHARE_PAGE_COMPLETED:"quickstart-state:sharePageCompleted",INTEGRATION_COMPLETED:"quickstart-state:integrationCompleted",HELP_COMPLETED:"quickstart-state:helpCompleted"},r="quickstart-checklist.create-space",i="quickstart-checklist.create-page",o="quickstart-checklist.invite-teammate",l="quickstart-checklist.share-page",u="quickstart-checklist.integration",s="quickstart-checklist.help",d={[i]:n.d,[o]:n.j},E={[r]:"createSpaceCompleted",[i]:"createPageCompleted",[o]:"inviteTeammateCompleted",[l]:"sharePageCompleted",[u]:"integrationCompleted",[s]:"helpCompleted"}},WiIw:function(e,t,a){"use strict";var n=a("Czhu"),c=a("ERkP"),r=a.n(c),i=a("a0gl"),o=a("RjSO"),l=a("Qdol"),u=a("aepo"),s=a("bPAi"),d=a("TSpG");const{PERSONAL_SPACE_EXP:E,ONBOARDING_NUDGE:b}=d.a,p=({featureFlagClient:e,cloudId:t,locale:a,expList:n=l.f})=>{const c=(({featureFlagClient:e,cloudId:t,locale:a,shouldTrackExposureEvent:n=!1})=>({[b]:Object(u.a)(e,{shouldTrackExposureEvent:n,locale:a,cloudId:t}),[E]:Object(s.a)(E,e,!1,a,t)}))({featureFlagClient:e,cloudId:t,locale:a});return Object.keys(c).filter(e=>c[e]).reduce((e,t)=>e.concat(...n[t]),[]).concat(...l.l)};var f=a("8TdO"),g=a("F4Ur"),k=a("rc7/"),y=a("btRf");const{OVERALL_STATE:O}=l.g,v=async({createAnalyticsEvent:e,skip:t=!1})=>{const a={};if(t)return a;try{const{data:e,loading:t}=await Object(f.getApolloClient)().query({query:y.a,variables:{key:Object.values(l.g)}});if(t)return a;const{onboardingState:c}=e;if(void 0!==c){var n;const e=(null!=(n=c.find(({key:e})=>e===O))?n.value:n)===l.b;c.forEach(({key:t,value:n})=>{a[t]=n===l.b||e})}}catch(c){A({createAnalyticsEvent:e,type:"sendOperationalEvent",action:"queryFailed",actionSubject:"onboardingData",source:"allOnboardingExp"}),Object(k.b)(c)&&Object(g.a)(c)}return a},m=async({key:e,createAnalyticsEvent:t,eligibleExperiences:a})=>{try{await Object(f.getApolloClient)().mutate({mutation:y.b,variables:{key:e,value:l.b},refetchQueries:[{query:y.a,variables:{key:Object.values(l.g)}}],awaitRefetchQueries:!0});const n=await v({createAnalyticsEvent:t});S({experiences:n,update:m,key:e,eligibleExperiences:a,createAnalyticsEvent:t}),A({createAnalyticsEvent:t,type:"sendOperationalEvent",action:"updateSucceeded",actionSubject:"onboardingData",source:e})}catch(n){A({createAnalyticsEvent:t,type:"sendOperationalEvent",action:"completionFailed",actionSubject:"onboarding",source:e})}},A=({createAnalyticsEvent:e,type:t,action:a,actionSubject:n,source:c})=>{e({type:t,data:{action:a,actionSubject:n,source:c}}).fire()},S=({experiences:e,update:t,eligibleExperiences:a,key:n,createAnalyticsEvent:c})=>{const r=Object.keys(e).filter(t=>!e[t]).filter(e=>a.includes(e)),i=e[O];n===O||i||i||0!==r.length||t({key:O,createAnalyticsEvent:c,eligibleExperiences:a})};a.d(t,"a",(function(){return j})),a.d(t,"b",(function(){return T}));const j=()=>{const{createAnalyticsEvent:e}=Object(o.a)(),{userId:t,featureFlagClient:a,cloudId:n,locale:r}=Object(i.a)(),u=!t,[s,d]=Object(c.useState)({}),E=p({featureFlagClient:a,cloudId:n,locale:r});Object(c.useEffect)(()=>{(async()=>{const t=await v({skip:u,createAnalyticsEvent:e});d(t)})()},[]);return{experiences:s,overallState:s[l.i],onboardingUpdate:t=>m({key:t,createAnalyticsEvent:e,eligibleExperiences:E})}},T=e=>t=>{const a=j();return r.a.createElement(e,Object(n.a)(Object(n.a)({},t),{},{onboardingData:a}))}},Zn5E:function(e,t,a){"use strict";a.r(t),a.d(t,"FLAGS",(function(){return d})),a.d(t,"OnboardingStateEditor",(function(){return E}));var n=a("ERkP"),c=a.n(n),r=a("1U1M"),i=a("zJ/j"),o=a("kC4U"),l=a("29F/"),u=a("Qdol"),s=a("btRf");const d=[...Object.values(l.f),...Object.values(u.g)],E=()=>{const{data:e,refetch:t}=Object(r.d)(s.a,{variables:{key:d},fetchPolicy:"cache-and-network"});return c.a.createElement("div",null,c.a.createElement("table",null,c.a.createElement("tbody",null,c.a.createElement("tr",{key:"header"},c.a.createElement("th",null,"Experience"),c.a.createElement("th",null,"Value"),c.a.createElement("th",null)),d.map((a,n)=>{var r,l;return c.a.createElement("tr",{key:a},c.a.createElement("td",null,a),c.a.createElement("td",null,(null!=(r=e)&&null!=(r=r.onboardingState)&&null!=(r=r[n])?r.value:r)||null),c.a.createElement("td",null,c.a.createElement(i.a,{onClick:(l=a,async()=>{await Object(o.a)("/wiki/rest/onboarding/1/store",{body:JSON.stringify({key:l}),method:"DELETE",headers:{"Content-Type":"application/json"}}),await t()}),appearance:"link"},"Reset")))}))))}},aepo:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("bPAi"),c=a("TSpG");const{ONBOARDING_NUDGE:r}=c.a,i=(e,{shouldTrackExposureEvent:t=!0,locale:a,cloudId:c})=>Object(n.a)(r,e,t,a,c)},bPAi:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a("HKB3");const c=(e,t,a=!0,c,r)=>{const i=Object(n.c)(t,e,a);if(i===n.a.ENROLLED)return!0;if(i===n.a.EXPERIMENT){if(t.getBooleanValue("confluence.frontend.onboarding.segment.holdout",{default:!1,shouldTrackExposureEvent:a})&&Object(n.d)(r))return!1;const e=t.getBooleanValue("confluence.frontend.onboarding.segment.en-only",{default:!0,shouldTrackExposureEvent:a}),i=/^en/i.test(c);if(e&&!i)return!1;return Object(n.c)(t,"confluence.frontend.onboarding.segment",a)===n.a.EXPERIMENT}return!1}},btRf:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i}));var n=a("H5qd"),c=a.n(n);const r=c.a`query AllOnboardingExpStatus($key:[String]){onboardingState(key:$key){key value}}`,i=c.a`mutation OnboardingStatusUpdateMutation($key:String$value:String)@experimental{experimentalCompleteOnboarding(key:$key value:$value){complete key}}`},ngiW:function(e,t,a){"use strict";a.r(t);var n=a("ERkP"),c=a.n(n),r=a("u6In"),i=a("a0gl"),o=a("cphC"),l=a("Qdol"),u=a("WiIw"),s=a("TSpG");const{ONBOARDING_STATE_UPDATE_FLAG:d}=s.a;var E=a("lPJD");a.d(t,"OnboardingStateUpdateComponent",(function(){return f}));const{OVERALL_STATE:b}=l.g,p=({onboardingUpdate:e,createAnalyticsEvent:t})=>(Object(n.useEffect)(()=>{e(b),t({type:"sendTrackEvent",data:{name:"onboardingStateUpdated",action:"onboardingStateUpdated",actionSubject:"page",actionSubjectId:"onboardingStateUpdate",source:"onboardingStateUpdate"}}).fire()},[]),null),f=Object(o.a)(Object(r.a)()(({createAnalyticsEvent:e,coordinationClient:t})=>{const{featureFlagClient:a,userId:n}=Object(i.a)(),{onboardingUpdate:r,overallState:o}=Object(u.a)();if(!(e=>e.getBooleanValue(d,{default:!1,shouldTrackExposureEvent:!0}))(a))return null;if(!n)return null;return!o?c.a.createElement(E.a,{client:t,messageId:"confluence-onboarding-state-update"},c.a.createElement(p,{onboardingUpdate:r,createAnalyticsEvent:e})):null}))}}]);
//# sourceMappingURL=onboarding-state-update~aea5bb3b.2jxgcLS6Zi.js.map