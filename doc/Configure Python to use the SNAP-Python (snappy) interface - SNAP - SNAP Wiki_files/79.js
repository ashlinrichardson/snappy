(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{"/Ixg":function(e,t,a){"use strict";var s,r,i=a("zjfJ"),n=a("ERkP"),c=a.n(n),o=a("RNvQ"),l=a.n(o),p=(a("aWzz"),a("L21V")),d=a("u6In"),h=a("Pf68"),u=a("JOcB"),f=a("Czhu"),g=a("KsTJ"),y=a("MwrP"),m=a.n(y),S=a("nnRT"),b=a.n(S),O=a("3IV/"),v=a("WEdt"),w=a("kYi3"),j=a("frZf"),x=a("mWiq"),T=a.n(x),E=a("a8dO"),P=a("MV18"),D=a("3VMZ");const L=()=>{},k=g.default.div`
  display: inline-block;
  opacity: ${e=>e.isGreyedOut?.5:1};
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
`,C=g.default.div`
  ${Object(v.h300)()};
  color: ${O.N200};
  min-width: 0;
  text-transform: ${e=>e.labelTextTransform};
  margin-bottom: 10px;
`,M=g.default.div`
  align-items: center;
  justify-content: flex-start;
  display: flex;
  flex-direction: row;
  line-height: 1.2;
  padding: 2px;
`,I=g.default.div`
  display: flex;
  flex: 0 1 auto;
  margin-right: 9px;
  margin-left: 6px;
  opacity: ${e=>e.isGreyedOut?.5:1};
`,R=g.default.img`
  background-image: url(${e=>j.a+e.src});
  width: 18px;
  height: 18px;
`,q=g.default.div`
  display: flex;
`,_={container:e=>Object(f.a)(Object(f.a)({},e),{},{width:"100%"}),dropdownIndicator:e=>Object(f.a)(Object(f.a)({},e),{},{paddingLeft:0}),menu:e=>Object(f.a)(Object(f.a)({},e),{},{width:"100%"}),input:e=>Object(f.a)(Object(f.a)({},e),{},{width:"100%",marginLeft:0,paddingLeft:"7px"}),option:(e,{isFocused:t})=>{const a=t?O.N900:null;let s;return t&&(s=O.N30),Object(f.a)(Object(f.a)({},e),{},{backgroundColor:s,color:a})},placeholder:e=>Object(f.a)(Object(f.a)({},e),{},{paddingLeft:"5px"}),valueContainer:e=>Object(f.a)(Object(f.a)({},e),{},{width:"100%",padding:"2px 8px 2px 0px"}),singleValue:e=>Object(f.a)(Object(f.a)({},e),{},{width:"100%",padding:"2px 8px 2px 0px"})},K={name:"",key:"default-key",iconPath:"/images/logo/default-space-logo-256.png",homepageId:""};function A({showSpaceLabel:e,labelTextTransform:t}){return!1===e?null:c.a.createElement(C,{labelTextTransform:t},c.a.createElement(p.c,{id:"space-selector.create.drawer.header",defaultMessage:"Select space",description:"The header of Space Selector"}))}const V=Object(p.h)((r=s=class extends n.PureComponent{static getDerivedStateFromProps(e,t){return(e.spaceKey===t.spaceKey||e.isLoading)&&!b()(t.currentSpace,K)||m()(e.defaultSpace)?Object(f.a)(Object(f.a)({},t),{},{isDisabled:e.isDisabled||e.spaceKey!==t.spaceKey&&e.isLoading}):Object(f.a)(Object(f.a)({},t),{},{currentSpace:e.defaultSpace,spaceKey:e.spaceKey,isDisabled:!1})}constructor(...e){super(...e),Object(i.a)(this,"onSelect",e=>{const{isRestricted:t,homepageId:a,homepageTitle:s}=e,r=e.key||"";this.setState({currentSpace:e}),this.props.fireAnalyticsEvent({type:"sendUIEvent",data:{source:this.props.analyticsSource,actionSubjectId:"spaceSelectorDropdownMenu",actionSubject:"spaceSelectorDropdownMenuItem",action:"clicked",attributes:{spaceKey:r}}}),this.props.onSelect({spaceKey:r,spaceName:e.name||"",isRestricted:t,homepageId:a,homepageTitle:s})}),Object(i.a)(this,"filterOption",this.props.filterOption?e=>{var t,a,s;return this.props.filterOption({spaceKey:(null!=(s=e)&&null!=(s=s.data)?s.key:s)||"",spaceName:(null!=(a=e)&&null!=(a=a.data)?a.name:a)||"",homepageId:(null!=(t=e)&&null!=(t=t.data)&&null!=(t=t.homepage)?t.id:t)||"",isRestricted:e.isRestricted})}:void 0),Object(i.a)(this,"getOption",({children:e,iconPath:t,name:a,isGreyedOut:s})=>c.a.createElement(M,null,this.renderSpaceIcon({iconPath:t,name:a,isGreyedOut:s}),e)),Object(i.a)(this,"getOptionLabel",e=>e.name),Object(i.a)(this,"getOptionValue",e=>e.key),Object(i.a)(this,"getLockIcon",()=>c.a.createElement(E.a,{content:this.props.intl.formatMessage({id:"space-selector.no.permission.to.create",defaultMessage:"You don't have create permissions in this space",description:"The tooltip message appearing next to lock icon in the space selector indicating that the space is restricted"})},c.a.createElement(T.a,{primaryColor:O.N300,label:this.props.intl.formatMessage({id:"space-selector.restricted-space.icon",description:"aria-label for the restricted content icon appearing in the space selector",defaultMessage:"This space is restricted"})}))),Object(i.a)(this,"getLabel",({name:e,iconPath:t,isRestricted:a},s)=>{const r=this.getOption,i=a&&"value"!==s;return c.a.createElement(r,{iconPath:t,name:e,isGreyedOut:i},c.a.createElement(k,{isGreyedOut:i,control:!0},e),c.a.createElement(q,null,a?this.getLockIcon():null))}),Object(i.a)(this,"formatOptionLabel",(e,{context:t})=>this.getLabel(e,t)),Object(i.a)(this,"noOptionsMessage",()=>c.a.createElement(p.c,{id:"space-selector.create.drawer.no.space.found",defaultMessage:"No space found",description:"The text inside the space selector drop down of create page drawer telling user that no space is found with the user query input"})),Object(i.a)(this,"loadingMessage",()=>c.a.createElement(p.c,{id:"space-selector.create.drawer.spaces.loading",defaultMessage:"Loading spaces",description:"The text inside the space selector drop down of create page drawer telling user it is searching for spaces"}));const[t]=e;this.state={currentSpace:m()(t.defaultSpace)?t.showDefaultSpace?K:null:t.defaultSpace,spaceKey:t.spaceKey}}renderSpaceIcon({iconPath:e,name:t,isGreyedOut:a}){const s=e&&0===e.indexOf(j.a)?e:`${j.a}${e}`;return c.a.createElement(I,{isGreyedOut:a},c.a.createElement(R,{src:s,label:t}))}render(){const{id:e,onChangeFilter:t,loadOptions:a,defaultOptions:s,placeholder:r,showSpaceLabel:i,isLoading:o,validationState:l,labelTextTransform:p}=this.props,{currentSpace:d,isDisabled:h}=this.state;return c.a.createElement(n.Fragment,null,c.a.createElement(A,{showSpaceLabel:i,labelTextTransform:p}),c.a.createElement(w.a,{"data-test-id":"space-select",placeholder:r,id:e,onChange:this.onSelect,value:d,isDisabled:h,isClearable:!1,noOptionsMessage:this.noOptionsMessage,loadingMessage:this.loadingMessage,loadOptions:a,defaultOptions:s,formatOptionLabel:this.formatOptionLabel,getOptionLabel:this.getOptionLabel,getOptionValue:this.getOptionValue,onInputChange:t,isMulti:!1,styles:_,validationState:l,filterOption:this.filterOption,classNamePrefix:"react-select"}),!o&&c.a.createElement(n.Fragment,null,c.a.createElement(P.a,{name:D.a.IN_EDITOR_TEMPLATES_LOAD_PANEL_SPACE_SELECTOR}),c.a.createElement(P.a,{name:D.a.TEMPLATE_GALLERY_SPACE_SELECTOR})))}},Object(i.a)(s,"defaultProps",{inputValue:"",fetchSpaces:L,onChangeFilter:L,onSelect:L,fireAnalyticsEvent:L,defaultOptions:[],loadOptions:Promise.resolve([]),defaultSpace:{},placeholder:c.a.createElement(p.c,{id:"space-selector.create.drawer.select.a.space",defaultMessage:"Select a space",description:"The placeholder of Space Selector"}),showDefaultSpace:!0,showSpaceLabel:!0}),r));var N=a("H5qd"),F=a.n(N);const $=F.a`query SpaceSelectorQuery($cql:String!$limit:Int){favoriteSpaces:spaces(offset:0 first:$limit favourite:true){nodes{id key name homepage{id title}operations{operation targetType}history{createdBy{displayName}}icon{path}}}searchedSpaces:search(cql:$cql first:$limit){count nodes{space{id homepage{id title}operations{operation targetType}key icon{path}name}}}user{id confluence{hasPersonalSpace space{id name key operations{operation targetType}homepage{id title}}}}recentlyVisitedSpaces:recentSpaces{key id name homepage{id title}icon{path}operations{operation targetType}}}`,z=F.a`query SpaceSelectorPromotedSpacesQuery@experimental{experimentalPromotedSpaces{nodes{id text}}}`,Q=F.a`query SpaceSelectorDefaultSpaceQuery($spaceKey:String!){defaultSpaces:spaces(spaceKey:$spaceKey first:1){nodes{id key name operations{operation targetType}homepage{id title}icon{path width height isDefault}type operations{operation targetType}}}}`,G=F.a`query SpaceSelectorRecentlyVisitedSpacesQuery{recentlyVisitedSpaces:recentSpaces{key id name icon{path}operations{operation targetType}}}`;var J,H;a.d(t,"a",(function(){return Y}));const W=()=>{},Y=Object(p.h)(Object(d.a)()((H=J=class extends n.Component{constructor(e){super(e),Object(i.a)(this,"fireAnalyticsEvent",e=>{"function"==typeof this.props.createAnalyticsEvent&&this.props.createAnalyticsEvent(e).fire()}),Object(i.a)(this,"_handleFilterChange",e=>{this.fireAnalyticsEvent({type:"sendUIEvent",data:{source:this.props.analyticsSource,actionSubjectId:"spaceSelectorDropdown",actionSubject:"spaceSelectorDropdownSearch",action:"search",attributes:{query:e}}}),this.setState({spaceQuery:e})}),Object(i.a)(this,"handleFilterChange",l()(this._handleFilterChange,500)),Object(i.a)(this,"onSelect",({spaceKey:e,spaceName:t,isRestricted:a,homepageId:s,homepageTitle:r})=>{const{onChange:i}=this.props;i({spaceKey:e,spaceName:t,isRestricted:a,homepageId:s,homepageTitle:r})}),Object(i.a)(this,"processData",e=>(e||[]).map(e=>{var t;return(null!=(t=e)?t.space:t)||e}).filter(e=>!!e).reduce((e,t)=>{const{name:a,key:s,icon:r,iconPath:i,id:n,text:c,operations:o,homepage:l}=t,p=r&&r.path||i||"",d=l&&l.id||"",h=l&&l.title||"";let u=!1;return o&&(u=!o.some(e=>!!this.props.operationsUsedToDetermineRestrictedStatus.find(t=>t.targetType===e.targetType&&t.operation===e.operation))),u&&!this.props.showRestrictedSpaces||e.push({name:a||c,key:s||n,iconPath:p,homepageId:d,homepageTitle:h,isRestricted:u}),e},[])),Object(i.a)(this,"getItems",(e,{favoriteSpaces:t,searchedSpaces:a,recentSpaces:s})=>[{label:this.props.intl.formatMessage({id:"create.drawer.space.selector.starred.spaces",defaultMessage:"Starred Spaces",description:"The text header inside the space selector drop down that show the list of user favorite spaces"}),options:e?[]:t,dataTestID:"starred-spaces"},{label:this.props.intl.formatMessage({id:"create.drawer.space.selector.recent.spaces",defaultMessage:"Recent Spaces",description:"The text header inside the space selector drop down that show the list of user recent visited spaces"}),options:e?[]:s,dataTestID:"recent-spaces"},{label:this.props.intl.formatMessage({id:"create.drawer.space.selector.search.spaces",defaultMessage:"All Spaces",description:"The text header inside the space selector drop down that show the spaces result after user enter query"}),options:e?a:[],dataTestID:"search-spaces"}]),Object(i.a)(this,"loadOptions",(e,t)=>(this._handleFilterChange(t),e({cql:this.getSpacesSearchCql(t),limit:25}).then(e=>{var a,s,r,i;const{data:n}=e,c=null!=(i=n)&&null!=(i=i.favoriteSpaces)?i.nodes:i,o=null!=(r=n)&&null!=(r=r.searchedSpaces)?r.nodes:r,l=null!=(s=n)?s.recentlyVisitedSpaces:s,p=(null!=(a=n)&&null!=(a=a.experimentalPromotedSpaces)?a.nodes:a)||[],d=!0===this.props.isAnonymous?p:l;return this.getItems(t,{favoriteSpaces:this.processData(c),searchedSpaces:this.processData(o),recentSpaces:this.processData(d)})}))),this.state={spaceQuery:null,spaceKey:e.spaceKey}}getSpacesSearchCql(e){let t="type = 'space'";return e&&(t+=` AND title ~ '${e.replace(/\'/g,"%27")}*'`),t}render(){const{spaceQuery:e}=this.state,{spaceKey:t}=this.props,a=[{query:$,errorPolicy:"all",fetchPolicy:"cache-first",variables:{cql:this.getSpacesSearchCql(e),limit:25},context:{single:!0}},{query:z,errorPolicy:"all",fetchPolicy:"cache-first",context:{single:!0}},{query:G,fetchPolicy:"cache-first",context:{single:!0}}];return t&&a.push({query:Q,fetchPolicy:"cache-first",variables:{spaceKey:t},context:{single:!0}}),c.a.createElement(u.a,{queryProps:a},({results:a,loading:s,properties:r})=>{var i,n,o,l,p,d;const[u,f,g,y]=a,[m]=r,S=(null!=(d=m)?d.refetch:d)||W,b=(null!=(p=u)&&null!=(p=p.data)&&null!=(p=p.favoriteSpaces)?p.nodes:p)||[],O=(null!=(l=u)&&null!=(l=l.data)&&null!=(l=l.searchedSpaces)?l.nodes:l)||[],v=this.processData((null!=(o=g)&&null!=(o=o.data)?o.recentlyVisitedSpaces:o)||[]),w=this.processData((null!=(n=y)&&null!=(n=n.data)&&null!=(n=n.defaultSpaces)?n.nodes:n)||[]),j=this.processData((null!=(i=f)&&null!=(i=i.data)&&null!=(i=i.experimentalPromotedSpaces)?i.nodes:i)||[]),x=!0===this.props.isAnonymous?j:v,T=w[0]||{};let E=this.processData(b);this.props.filterDefaultFromResults&&(E=E.filter(e=>e.key!==T.key));let P=x;if(this.props.filterStarredFromRecent){const e=new Set(E.map(e=>e.key));P=P.filter(t=>!e.has(t.key))}this.props.filterDefaultFromResults&&(P=P.filter(e=>e.key!==T.key));const D=this.getItems(e,{favoriteSpaces:E,searchedSpaces:this.processData(O),recentSpaces:P});return c.a.createElement(V,{onSelect:this.onSelect,fireAnalyticsEvent:this.fireAnalyticsEvent,id:this.props.id,isLoading:s,searchKeyword:e,onChangeFilter:this.handleFilterChange,defaultSpace:T,defaultOptions:D,loadOptions:Object(h.a)((...e)=>this.loadOptions(S,...e),500),placeholder:this.props.placeholder,spaceKey:t,showDefaultSpace:this.props.showDefaultSpace,showSpaceLabel:this.props.showSpaceLabel,validationState:this.props.validationState,filterOption:this.props.filterOption,isDisabled:this.props.isDisabled,labelTextTransform:this.props.labelTextTransform,analyticsSource:this.props.analyticsSource})})}},Object(i.a)(J,"displayName","SpaceSelector"),Object(i.a)(J,"defaultProps",{onChange:W,createAnalyticsEvent:()=>({fire:W}),showDefaultSpace:!0,showRestrictedSpaces:!0,showSpaceLabel:!0,validationState:"default",isDisabled:!1,filterDefaultFromResults:!0,filterStarredFromRecent:!1,labelTextTransform:"uppercase",analyticsSource:"createPageDrawer",operationsUsedToDetermineRestrictedStatus:[{targetType:"space",operation:"update"},{targetType:"page",operation:"create"}]}),H)))},JOcB:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var s=a("Czhu"),r=a("HbGN"),i=a("zjfJ"),n=a("ERkP"),c=a.n(n),o=a("gQ5V");a("aWzz");class l extends n.Component{constructor(...e){super(...e),Object(i.a)(this,"_queryResults",[]),Object(i.a)(this,"_queryProperties",[]),Object(i.a)(this,"_anyLoading",()=>this._queryResults.some(e=>!0===e.loading)),Object(i.a)(this,"_renderQueryComponent",(e,t,a)=>e.length?c.a.createElement(o.b,Object(s.a)({errorPolicy:"all"},e[a]),s=>{let{data:i,loading:n,error:c}=s,o=Object(r.a)(s,["data","loading","error"]);this._queryResults[a]={data:i,loading:n,error:c},this._queryProperties[a]=o;const l=a+1;return e.length>l?this._renderQueryComponent(e,t,l):t({results:this._queryResults,loading:this._anyLoading(),properties:this._queryProperties})}):t({results:[],loading:!1}))}render(){const{queryProps:e,children:t}=this.props;return this._renderQueryComponent(e,t,0)}}},MwrP:function(e,t,a){var s=a("4uJK"),r=a("kkM+"),i=a("bvyN"),n=a("wxYD"),c=a("9y2L"),o=a("3ajY"),l=a("CbIe"),p=a("Qd2C"),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(c(e)&&(n(e)||"string"==typeof e||"function"==typeof e.splice||o(e)||p(e)||i(e)))return!e.length;var t=r(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(l(e))return!s(e).length;for(var a in e)if(d.call(e,a))return!1;return!0}},Pf68:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));const s=(e,t=0)=>{let a=null,s=[];return(...r)=>(clearTimeout(a),a=setTimeout(()=>{const t=e(...r);s.forEach(e=>e(t)),s=[]},t),new Promise(e=>s.push(e)))}},mWiq:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(a("ERkP")),r=i(a("4KTy"));function i(e){return e&&e.__esModule?e:{default:e}}function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e}).apply(this,arguments)}var c=function(e){return s.default.createElement(r.default,n({dangerouslySetGlyph:'<svg width="24" height="24" viewBox="0 0 24 24" focusable="false" role="presentation"><g fill="currentColor"><path d="M16 11V9h-2V7.002A2.001 2.001 0 0 0 12 5c-1.102 0-2 .898-2 2.002V9H8v2H7v8h10v-8h-1zm-2 0h-4V9h4v2zM8 9V7.002A4.004 4.004 0 0 1 12 3a4 4 0 0 1 4 4.002V9h.994A2.01 2.01 0 0 1 19 11.009v7.982c0 1.11-.897 2.009-2.006 2.009H7.006A2.009 2.009 0 0 1 5 18.991V11.01C5 9.899 5.897 9 7.006 9H8zm0 0h2v2H8V9zm6 0h2v2h-2V9z"/><circle cx="12" cy="15" r="2"/></g></svg>'},e))};c.displayName="LockIcon";var o=c;t.default=o}}]);
//# sourceMappingURL=79.BmUdoTuezx.js.map